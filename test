<script>
function parseDurationToMinutes(durationStr) {
    const parts = durationStr.split(":");
    if (parts.length === 3) {
        const h = parseInt(parts[0], 10);
        const m = parseInt(parts[1], 10);
        const s = parseInt(parts[2], 10);
        return h * 60 + m + s / 60;
    }
    return 0;
}

function addThroughputToTable(tableId) {
    const table = document.getElementById(tableId);
    if (!table) return;

    const rows = table.getElementsByTagName("tr");

    // Add new header
    const header = rows[0].getElementsByTagName("th");
    const newHeader = document.createElement("th");
    newHeader.innerText = "Throughput (ID/min)";
    header[header.length - 1].after(newHeader);

    // Go through data rows
    for (let i = 1; i < rows.length; i++) {
        const cells = rows[i].getElementsByTagName("td");
        if (cells.length >= 5) {
            const durationStr = cells[3].innerText;
            const processed = parseInt(cells[4].innerText, 10);
            const durationMin = parseDurationToMinutes(durationStr);
            const throughput = durationMin > 0 ? (processed / durationMin).toFixed(2) : "N/A";

            const newCell = document.createElement("td");
            newCell.innerText = throughput;
            cells[4].after(newCell);
        }
    }
}

addThroughputToTable("START_TOP_BATCH_TABLE");
addThroughputToTable("START_LAST_COB_TABLE");
</script>
